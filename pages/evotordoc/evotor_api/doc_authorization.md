---
title: Авторизация
keywords:
summary:
sidebar: evotordoc_sidebar
permalink: doc_authorization.html
tags: [Cloud]
folder: evotor_api
---

В зависимости от типа приложения, для работы с Облаком Эвотор вам могут понадобиться следующие токены:

* токен стороннего сервиса;
* токен пользователя;
* токен приложения.


### Токен стороннего сервиса {#serverToken}

Сторонний сервис использует токен для авторизации запросов Облака Эвотор в рамках работы с учётной записью в стороннем сервисе. Облако передаёт токен стороннего сервиса в заголовке `Authorization`. Токен необходим для авторизации следующих запросов и уведомлений:

* [Регистрация новой учётной записи](https://api.evotor.ru/docs/#tag/Vebhuki-zaprosy%2Fpaths%2F~1partner.ru~1api~1v1~1user~1create%2Fpost)
* [Авторизация существующего пользователя](https://api.evotor.ru/docs/#tag/Vebhuki-zaprosy%2Fpaths%2F~1partner.ru~1api~1v1~1user~1verify%2Fpost)
* [События подписки](https://api.evotor.ru/docs/#tag/Vebhuki-uvedomleniya%2Fpaths%2F~1partner.ru~1api~1v1~1subscription~1event%2Fpost)
* [События установки и удаления приложений](https://api.evotor.ru/docs/#tag/Vebhuki-uvedomleniya%2Fpaths%2F~1partner.ru~1api~1v2~1installation~1event%2Fpost)
* [Адрес для получения токена приложения](https://api.evotor.ru/docs/#tag/Vebhuki-zaprosy%2Fpaths%2F~1partner.ru~1api~1v1~1user~1token%2Fpost)

Чтобы задать токен стороннего сервиса:

1. На сайте [dev.evotor.ru](https://dev.evotor.ru/) выберите приложение для которого требуется задать токен.
2. На вкладке **Интеграция** выберите необходимый параметр (например, **События биллинга**) и укажите:

  * Токен в формате uuid4, если ваш сервис использует bearer-авторизацию.
  * Логин и пароль для доступа к вашему сервису, если он использует basic-авторизацию.

В ответ на запросы [Регистрация новой учётной записи](https://api.evotor.ru/docs/#tag/Vebhuki-zaprosy%2Fpaths%2F~1partner.ru~1api~1v1~1user~1create%2Fpost) и [Авторизация существующего пользователя](https://api.evotor.ru/docs/#tag/Vebhuki-zaprosy%2Fpaths%2F~1partner.ru~1api~1v1~1user~1verify%2Fpost) сторонний сервис возвращает в Облако *токен пользователя*.

### Токен пользователя {#usersToken}

При создании нового или авторизации существующего пользователя, сторонний сервис возвращает в Облако уникальный *токен пользователя*. Облако передаёт токен в заголовке `Authorization` запросов приложения к стороннему сервису.

### Токен приложения

Облако присваивает токен приложения каждому установленному приложению и с его помощью определяет в рамках какого пользователя действуют запросы стороннего сервиса. При запросе к REST API Облака Эвотор, например, для получения списка товаров или магазинов пользователя, сторонний сервис передаёт *токен приложения* в заголовке `X-Authorization`.
Получить токен, который Облако выдало установленному приложению, вы можете одним из способов:

* по адресу [`partner.ru/api/v1/user/token`](https://api.evotor.ru/docs/#tag/Vebhuki-zaprosy%2Fpaths%2F~1partner.ru~1api~1v1~1user~1token%2Fpost).

    Авторизуйте запросы Облака с помощью токена стороннего сервиса.

* В GET-параметре `token` веб-адреса iframe-приложения:
  ```curl
  https://partner.org/#/?uid=<example>&token=string
  ```

  {: .center-image}
  ![Токен из iframe'а](images/iframe_token.png)

* В [Личном кабинете пользователя Эвотор](https://lk.evotor.ru/web/login), в разделе **Настройки** приложения.

   В этом случае, пользователю требуется вручную указать токен в интерфейсе стороннего приложения. Такой метод рекомендуется при работе с интеграциями 1С.

Чтобы отображать токен на вкладке настроек приложения:

1. На сайте [dev.evotor.ru](https://dev.evotor.ru) выберите приложение для которого требуется задать токен.
2. На вкладке **Интеграция** установите флажок **Создать закладку "Настройки" на странице приложения**.
3. В блоке **Настройка формы** нажмите на кнопку **Текстовое поле** и укажите поля:

    * **FormData name** – Название поля, например, "Токен приложения".
    * **Значение поля** – `${token}`, переменная, которая автоматически заменяется на токен приложения, полученный в базе данных.
    * **Подсказка к полю** – при необходимости, укажите здесь дополнительную информацию.

    {: .center-image}
    ![Настройка токена на вкладке Интеграция](images/users_token_setting_up.png)

Токен приложения будет автоматически скопирован из базы данных и отображён в поле **Токен приложения** на вкладке **Настройки**, в [Личном кабинете пользователя Эвотор](https://lk.evotor.ru/web/login).

{: .center-image}
![Токен пользователя в Личном кабинете](images/users_token.png)
