---
title: Интеграция с облачными сервисами
keywords:
summary: "Раздел содержит информацию об интеграции с облачной товароучётной системой."
sidebar: evotordoc_sidebar
permalink: doc_cloud_systems_integration.html
tags: [cloud, products]
folder: tutorials
---

Облачная товароучётная система это сторонний сервис, который позволяет  пользователям взаимодействовать с сущностями предприятия: магазинами, сотрудниками и товарами.

Для пользователей Эвотора интеграция выглядит как приложение, которое можно купить в Магазине приложений. Купленные приложения отображаются в Личном кабинете, в разделе **Мои приложения**.

Перед интеграцией, убедитесь, что облачная  товароучётная система поддерживает адреса, указанные в таблице ниже.

|   URL      |   Назначение   |       Авторизация      |     Дополнительно   |
|:-----------|:---------------|:-----------------------|:--------------------|
| https://example.com/api/v1/user/create | Эвотор отправляет по адресу регистрационные данные для создания новой учётной записи в облачной товароучётной системе. | Товароучётная система авторизует запрос облака с помощью имени пользователя и пароля (basic-авторизация) или токена (bearer-авторизация).|                       |
| https://example.com/api/v1/user/verify | Эвотор отправляет по адресу данные для авторизации пользователя в облачной товароучётной системе с помощью ранее созданной учётной записи.|           |
| https://example.com/api/v1/user/token  | Эвотор отправляет по адресу токен приложения, с помощью которого будет авторизовывать запросы от товароучётной системы.|                     |
| https://example.com/api/v1/subscription/event  | Эвотор отправляет по адресу события сообщающие об изменении подписки на приложение.|                     |

{% include note.html content="Информацию о сущностях пользователя Эвотор (магазинах, товарах, сотрудниках и смарт-терминалах), товароучётная система получает с помощью запросов к облаку Эвотор." %}

## Покупка и активация приложения

{: .center-image}
![Схема покупки и активации приложения](images/cloud_application_handling.png "Схема покупки и активации приложения")

### Этап 1

{% include embeds/application_installation_stage1.html %}

### Этап 2

{% include embeds/application_installation_stage2.html %}

## Удаление и деактивация приложения

Эвотор останавливает интеграцию и удаляет приложение если:

* пользователь самостоятельно удалил приложение в разделе **Мои приложения** в Личном кабинете пользователя Эвотор;
* у пользователя недостаточно средств для продления подписки.
  В этом случае, за пять дней до отключения приложения, Эвотор начинает рассылать пользователю смс с предупреждением о скором отключении приложения.

В обоих случаях, после удаления приложения, Эвотор передаёт в сторонний сервис запрос [**\[POST\] Активация / деактивация тарифа**](https://goo.gl/V71Guj) с состоянием `INACTIVE`.

### Повторная установка приложения

При повторной установке приложения, Эвотор проверяет истёк пробный период использования приложения или нет. Так же, в зависимости от значения параметра `hasBilling`, возможно изменение стороны ответственной за биллинг пользователя.

### Подробная схема покупки и установки приложения

{% include image.html file="market_app_install_schema.png" url="images/market_app_install_schema.png" caption="Схема покупки и установки приложения" %}
